#!/bin/bash
set -e

# Limpia la carpeta de trabajo por si queda algo (opcional)
rm -rf /opt/app-root/src/*

# Mueve el c√≥digo fuente que s2i inyecta en /tmp/src a la carpeta de trabajo
mv /tmp/src/* /opt/app-root/src/

# Opcional: si usas git y quieres limpiar archivos ocultos
rm -rf /opt/app-root/src/.git*

# Instalar las dependencias de Python desde requirements.txt
pip install --no-cache-dir -r /opt/app-root/src/requirements.txt

# Cambiar permisos para evitar problemas en OpenShift
chown -R 1001:0 /opt/app-root/src
chmod -R g+w /opt/app-root/src
